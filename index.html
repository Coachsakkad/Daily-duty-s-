<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="مذكرة الكوتش - تطبيق لإدارة المهام والملاحظات والعمليات المالية">
    <meta name="author" content="مذكرة الكوتش">
    <title>مذكرة الكوتش - دمشق محافظة</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner" aria-hidden="true">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">جاري التحميل...</span>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-dark bg-dark" role="navigation">
        <div class="container-fluid">
            <span class="navbar-brand">
                <i class="bi bi-journal-text me-2" aria-hidden="true"></i>
                مذكرة الكوتش - دمشق محافظة
            </span>
        </div>
    </nav>

    <!-- Toast Container -->
    <div class="toast-container" aria-live="polite" aria-atomic="true"></div>

    <!-- Main Content -->
    <main class="container mt-4" role="main">
        <!-- Tabs Navigation -->
        <nav>
            <ul class="nav nav-tabs" id="myTab" role="tablist" aria-label="أقسام التطبيق">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="tasks-tab" data-bs-toggle="tab" data-bs-target="#tasks" 
                            type="button" role="tab" aria-controls="tasks" aria-selected="true">
                        <i class="bi bi-check-square me-2" aria-hidden="true"></i>
                        المهام اليومية
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="notes-tab" data-bs-toggle="tab" data-bs-target="#notes" 
                            type="button" role="tab" aria-controls="notes" aria-selected="false">
                        <i class="bi bi-sticky me-2" aria-hidden="true"></i>
                        الملاحظات الفورية
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="transactions-tab" data-bs-toggle="tab" data-bs-target="#transactions" 
                            type="button" role="tab" aria-controls="transactions" aria-selected="false">
                        <i class="bi bi-table me-2" aria-hidden="true"></i>
                        جدول العمليات
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="traders-tab" data-bs-toggle="tab" data-bs-target="#traders" 
                            type="button" role="tab" aria-controls="traders" aria-selected="false">
                        <i class="bi bi-people me-2" aria-hidden="true"></i>
                        جداول التجار
                    </button>
                </li>
            </ul>
        </nav>

        <!-- Tab Content -->
        <div class="tab-content" id="myTabContent">
            <!-- Tasks Tab -->
            <div class="tab-pane fade show active" id="tasks" role="tabpanel" aria-labelledby="tasks-tab">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="bi bi-check-square me-2" aria-hidden="true"></i>
                        المهام اليومية
                    </h2>
                </div>
                
                <form id="taskForm" class="mb-4" novalidate>
                    <div class="input-group">
                        <input type="text" class="form-control" id="taskInput" 
                               placeholder="أدخل المهمة الجديدة..." 
                               aria-label="نص المهمة الجديدة"
                               maxlength="200" required>
                        <button class="btn btn-success" type="submit" aria-label="إضافة مهمة جديدة">
                            <i class="bi bi-plus-lg me-1" aria-hidden="true"></i>
                            إضافة
                        </button>
                    </div>
                    <div class="invalid-feedback">الرجاء إدخال مهمة صحيحة (1-200 حرف).</div>
                </form>

                <div id="tasksContainer" aria-live="polite">
                    <ul class="list-group" id="taskList" role="list" aria-label="قائمة المهام"></ul>
                </div>
                
                <div id="notifications" class="alert alert-info mt-3 d-none" role="alert" aria-live="polite"></div>
            </div>

            <!-- Notes Tab -->
            <div class="tab-pane fade" id="notes" role="tabpanel" aria-labelledby="notes-tab">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="bi bi-sticky me-2" aria-hidden="true"></i>
                        الملاحظات الفورية
                    </h2>
                </div>
                
                <form id="noteForm" class="mb-4" novalidate>
                    <div class="mb-3">
                        <textarea class="form-control" id="noteInput" 
                                  placeholder="أدخل ملاحظاتك هنا..." 
                                  rows="4" aria-label="نص الملاحظة الجديدة"
                                  maxlength="1000" required></textarea>
                        <div class="invalid-feedback">الرجاء إدخال ملاحظة صحيحة (1-1000 حرف).</div>
                    </div>
                    <button class="btn btn-success" type="submit" aria-label="إضافة ملاحظة جديدة">
                        <i class="bi bi-plus-lg me-1" aria-hidden="true"></i>
                        إضافة ملاحظة
                    </button>
                </form>

                <div id="notesContainer" aria-live="polite">
                    <ul class="list-group" id="noteList" role="list" aria-label="قائمة الملاحظات"></ul>
                </div>
            </div>

            <!-- Transactions Tab -->
            <div class="tab-pane fade" id="transactions" role="tabpanel" aria-labelledby="transactions-tab">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="bi bi-table me-2" aria-hidden="true"></i>
                        جدول العمليات
                    </h2>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-bordered table-hover" id="transactionTable" role="table">
                        <thead class="table-success">
                            <tr>
                                <th scope="col">التاريخ</th>
                                <th scope="col">العملية</th>
                                <th scope="col">دفع</th>
                                <th scope="col">قبض</th>
                                <th scope="col">مكالمة</th>
                                <th scope="col">اتصال</th>
                                <th scope="col">أخرى</th>
                                <th scope="col">إجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="transactionBody"></tbody>
                    </table>
                </div>
                
                <form id="transactionForm" class="mt-4" novalidate>
                    <div class="row g-3">
                        <div class="col-md-6 col-lg-3">
                            <label for="transDate" class="form-label">التاريخ *</label>
                            <input type="date" class="form-control" id="transDate" required>
                            <div class="invalid-feedback">الرجاء إدخال تاريخ صحيح.</div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <label for="transOperation" class="form-label">العملية *</label>
                            <input type="text" class="form-control" id="transOperation" 
                                   placeholder="وصف العملية" maxlength="100" required>
                            <div class="invalid-feedback">الرجاء إدخال وصف العملية (1-100 حرف).</div>
                        </div>
                        <div class="col-md-6 col-lg-2">
                            <label for="transPay" class="form-label">دفع</label>
                            <input type="number" class="form-control" id="transPay" 
                                   placeholder="0" min="0" step="0.01">
                        </div>
                        <div class="col-md-6 col-lg-2">
                            <label for="transReceive" class="form-label">قبض</label>
                            <input type="number" class="form-control" id="transReceive" 
                                   placeholder="0" min="0" step="0.01">
                        </div>
                        <div class="col-md-4">
                            <label for="transCall" class="form-label">مكالمة</label>
                            <input type="text" class="form-control" id="transCall" 
                                   placeholder="تفاصيل المكالمة" maxlength="100">
                        </div>
                        <div class="col-md-4">
                            <label for="transContact" class="form-label">اتصال</label>
                            <input type="text" class="form-control" id="transContact" 
                                   placeholder="معلومات الاتصال" maxlength="100">
                        </div>
                        <div class="col-md-4">
                            <label for="transOther" class="form-label">أخرى</label>
                            <input type="text" class="form-control" id="transOther" 
                                   placeholder="معلومات إضافية" maxlength="100">
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-plus-lg me-1" aria-hidden="true"></i>
                                إضافة عملية
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Traders Tab -->
            <div class="tab-pane fade" id="traders" role="tabpanel" aria-labelledby="traders-tab">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="bi bi-people me-2" aria-hidden="true"></i>
                        جداول التجار
                    </h2>
                </div>
                
                <form id="traderForm" class="mb-4" novalidate>
                    <div class="row g-3">
                        <div class="col-md-5">
                            <label for="traderName" class="form-label">اسم التاجر *</label>
                            <input type="text" class="form-control" id="traderName" 
                                   placeholder="أدخل اسم التاجر" maxlength="50" required>
                            <div class="invalid-feedback">الرجاء إدخال اسم التاجر (1-50 حرف).</div>
                        </div>
                        <div class="col-md-5">
                            <label for="traderAmount" class="form-label">المبلغ *</label>
                            <input type="number" class="form-control" id="traderAmount" 
                                   placeholder="أدخل المبلغ" min="0" step="0.01" required>
                            <div class="invalid-feedback">الرجاء إدخال مبلغ صحيح.</div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">&nbsp;</label>
                            <button type="submit" class="btn btn-success d-block w-100">
                                <i class="bi bi-plus-lg me-1" aria-hidden="true"></i>
                                إضافة
                            </button>
                        </div>
                    </div>
                </form>
                
                <div id="tradersContainer" aria-live="polite">
                    <div id="traderTables"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for Editing -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">
                        <i class="bi bi-pencil-square me-2" aria-hidden="true"></i>
                        تعديل
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="إغلاق"></button>
                </div>
                <div class="modal-body" id="editModalBody"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg me-1" aria-hidden="true"></i>
                        إلغاء
                    </button>
                    <button type="button" class="btn btn-primary" id="saveEdit">
                        <i class="bi bi-check-lg me-1" aria-hidden="true"></i>
                        حفظ التغييرات
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmModalLabel">
                        <i class="bi bi-exclamation-triangle me-2" aria-hidden="true"></i>
                        تأكيد الحذف
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="إغلاق"></button>
                </div>
                <div class="modal-body" id="confirmModalBody">
                    هل أنت متأكد من أنك تريد حذف هذا العنصر؟ لا يمكن التراجع عن هذا الإجراء.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg me-1" aria-hidden="true"></i>
                        إلغاء
                    </button>
                    <button type="button" class="btn btn-danger" id="confirmDelete">
                        <i class="bi bi-trash me-1" aria-hidden="true"></i>
                        حذف
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="script.js"></script>
</body>
</html>

